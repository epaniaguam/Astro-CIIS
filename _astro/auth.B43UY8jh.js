import{U as l}from"./endpoints.DprMjbcE.js";/*! js-cookie v3.0.5 | MIT */function u(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)e[n]=t[n]}return e}var w={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function p(e,r){function t(o,a,s){if(!(typeof document>"u")){s=u({},r,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in s)s[i]&&(c+="; "+i,s[i]!==!0&&(c+="="+s[i].split(";")[0]));return document.cookie=o+"="+e.write(a,o)+c}}function n(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var a=document.cookie?document.cookie.split("; "):[],s={},c=0;c<a.length;c++){var i=a[c].split("="),y=i.slice(1).join("=");try{var d=decodeURIComponent(i[0]);if(s[d]=e.read(y,d),o===d)break}catch{}}return o?s[o]:s}}return Object.create({set:t,get:n,remove:function(o,a){t(o,"",u({},a,{expires:-1}))},withAttributes:function(o){return p(this.converter,u({},this.attributes,o))},withConverter:function(o){return p(u({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(e)}})}var f=p(w,{path:"/"});function j(){try{const e=JSON.parse(f.get("user")||"{}");return e&&Object.keys(e).length>0?e:null}catch(e){return console.error("Error al parsear la cookie del usuario",e),null}}function h(e,r=2){f.set("user",JSON.stringify(e),{expires:r/24})}function v(e,r){return console.error(e),{error:e?.error||"Ha ocurrido un error",reason:e?.reason||r}}function g(e,r="/dashboard"){const n=new URLSearchParams(location.search).get("next")||r;h(e),location.href=n}const C=(e,r)=>new Promise(async(t,n)=>{try{const o=await fetch(l.session.src,{method:"POST",body:JSON.stringify({email:e,password:r}),headers:{"Content-Type":"application/json"},credentials:"include"});if(!o.ok)throw await o.json();const a=await o.json();g(a),t(a)}catch(o){n(v(o,"En este momento el servidor no está disponible, inténtelo más tarde"))}}),U=(e="/")=>{f.remove("user"),location.href=e};function m(e){h(e)}async function P(e){try{const[r,t]=await Promise.all([fetch(l.user.inscription+"?type_event=postmaster&event=14",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),fetch(l.user.inscription+"?type_event=ciis&event=15",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})]),[n,o]=await Promise.all([r.json(),t.json()]);e.dataPostmaster=n.status,e.dataCiis=o.status,m(e)}catch(r){console.error("Error actualizando el estado del usuario",r)}}async function T(){return new Promise(async(e,r)=>{try{const t=await fetch(l.google.sign,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok)throw await t.json();const{url:n}=await t.json();e(n)}catch(t){console.log(t)}})}async function x(e){return new Promise(async(r,t)=>{try{const n=await fetch(`${l.google.user}?access_token=${e}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!n.ok)throw await n.json();const o=await n.json();g(o,o?.dni?"/dashboard":"/dashboard/account"),r(o)}catch(n){console.log(n)}})}const k=Object.freeze(Object.defineProperty({__proto__:null,createSession:g,getUser:j,getUserGoogleoauth:x,googleoauth:T,login:C,logout:U,setUser:h,updateStatusUser:P,updateUser:m},Symbol.toStringTag,{value:"Module"}));export{T as a,C as b,k as c,x as g,U as l};
